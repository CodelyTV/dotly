#!/usr/bin/env bash

set -euo pipefail

source "$DOTLY_PATH/scripts/core/_main.sh"

##? Update dotly to the latest stable release
##?
##? Usage:
##?    update
docs::parse "$@"

cd "$DOTFILES_PATH"
branch=$(git config -f .gitmodules submodule.modules/dotly.branch)

cd "$DOTLY_PATH"
git discard >/dev/null 2>&1
git checkout "$branch" >/dev/null 2>&1
git pull >/dev/null 2>&1
git submodule update --init --recursive > /dev/null 2>&1

output::answer 'âœ… dotly updated to the latest version'

rm -f "$DOTFILES_PATH/.dotly_update_available"